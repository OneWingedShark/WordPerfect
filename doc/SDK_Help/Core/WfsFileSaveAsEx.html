<?xml version="1.0" encoding="iso-8859-1"?>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
  

  <title>WfsFileSaveAsEx function</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
  <style type="text/css">
/*<![CDATA[*/
  div.c2 {text-align: left}
  div.c1 {margin-left: 2em}
  /*]]>*/
  </style>
</head>

<body>
  <table border="0" width="100%">
    <tr>
      <td width="23"><a href="WfsFileOpenEx.html"><img alt="Previous Document" border="0" src="images/prev.gif" width="18" height="18" /></a></td>
      <td width="23"><a href="SDK_TOC.html"><img alt="Table Of Contents" border="0" src="images/BtnBacktoTop.gif" width="18" height="18" /></a></td>
      <td width="23"><a href="WfsGetCurDir.html"><img alt="Next Document" border="0" src="images/next.gif" width="18" height="18" /></a></td>

      <td>
        <p class="pBody"><a href="PerfectFit_reference.html">Using PerfectFit</a> : <a href="File_System.html">Providing file-management capabilities</a> :
        WfsFileSaveAsEx function</p>
      </td>
    </tr>
  </table>
  <hr width="100%" size="1" color="#0000CC" />
  <a name="wp547639"></a>

  <h4 class="pHeading3">WfsFileSaveAsEx function</h4><a name="wp547641"></a>

  <p class="pBody">The <code class="cCode">WfsFileSaveAsEx</code> function opens the File Save As dialog box for the user. All input and output strings for
  this function are assumed to be ANSI strings.</p><a name="wp547643"></a>

  <h5 class="pHeading4">Prototype</h5>

  <div class="pPreformatted">
    <pre class="pPreformatted">
WORD SHAPI WfsFileSaveAsEx (<a name="wp547645"> </a>
HWND hParent,<a name="wp547647"> </a>
LPSTR lpszPath,<a name="wp547649"> </a>
LPSTR lpszFileName,<a name="wp547651"> </a>
LPSTR lpszTemplate,<a name="wp547653"> </a>
LPSTR lpszUserEntered,<a name="wp547655"> </a>
LPSTR Title,<a name="wp547657"> </a>
LPSTR ButtonText,<a name="wp547659"> </a>
LPDWORD lpdwExportType,<a name="wp547661"> </a>
DWORD dwOptionsIn,<a name="wp547663"> </a>
LPDWORD dwOptionsOut,<a name="wp547665"> </a>
FARPROC pfnQueryCnt,<a name="wp547667"> </a>
FARPROC pfnFormat,<a name="wp547669"> </a>
DWORD dwCvtClass );<a name="wp547671"> </a>
</pre>
  </div><a name="wp547673"></a>

  <h5 class="pHeading4">Parameters</h5><a name="wp547676"></a>

  <p class="pBody"></p>

  <div class="c2">
    <table border="1">
      <tr align="left">
        <td>
          <a name="wp1276944"></a>

          <p class="pBody"><code class="cCode">hParent</code></p>
        </td>

        <td>
          <a name="wp1276946"></a>

          <p class="pBody">Specifies the handle of the window to use as parent of <code class="cCode">File Open</code> dialog box. <code class=
          "cCode">NULL</code> is also valid.</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276948"></a>

          <p class="pBody"><code class="cCode">lpszPath</code></p>
        </td>

        <td>
          <a name="wp1276950"></a>

          <p class="pBody">Acts as a pointer to the path for the list display. This parameter can be passed as <code class="cCode">NULL</code>. It is returned
          as the path of the list display and should be of size <code class="cCode">FS_PATHNAME_BUFSIZE</code> (<code class="cCode">143</code>). It may be
          different from the path of the file that was saved.</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276952"></a>

          <p class="pBody"><code class="cCode">lpszFileName</code></p>
        </td>

        <td>
          <a name="wp1276954"></a>

          <p class="pBody">Acts as a pointer to the filename to be displayed in the edit field. A pathname can be included. This parameter may be passed as
          <code class="cCode">NULL</code>. It is returned as the path and filename of the file to be saved, and it should be of size <code class=
          "cCode">FS_FILENAME_LEN</code> (<code class="cCode">155</code>).</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276956"></a>

          <p class="pBody"><code class="cCode">lpszTemplate</code></p>
        </td>

        <td>
          <a name="wp1276958"></a>

          <p class="pBody">Acts as a pointer to the file template to use in the list. (A file template is a filename that may contain wildcard characters.)
          This parameter may be passed as <code class="cCode">NULL</code>.</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276960"></a>

          <p class="pBody"><code class="cCode">lpszUseEntered</code></p>
        </td>

        <td>
          <a name="wp1276962"></a>

          <p class="pBody">Acts as a pointer to the buffer to contain the exact string the user entered in the Filename edit field. This buffer should be of
          size <code class="cCode">FS_FILENAME_LEN</code> (<code class="cCode">155</code>).</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276964"></a>

          <p class="pBody"><code class="cCode">lpszTitle</code></p>
        </td>

        <td>
          <a name="wp1276966"></a>

          <p class="pBody">Acts as a pointer to the string to use as the dialog box title. If this parameter is passed as <code class="cCode">NULL</code>, the
          default text <code class="cCode">"Save As"</code> is used.</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276968"></a>

          <p class="pBody"><code class="cCode">lpszButtonText</code></p>
        </td>

        <td>
          <a name="wp1276970"></a>

          <p class="pBody">Acts as a pointer to the text to be used on the dialog box Save button. This parameter can be passed as <code class=
          "cCode">NULL</code> to use the default text <code class="cCode">"Save"</code>.</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276972"></a>

          <p class="pBody"><code class="cCode">lpdwExportType</code></p>
        </td>

        <td>
          <a name="wp1276974"></a>

          <p class="pBody">Acts as a pointer to the default export file type of the file to be saved. It is returned as the selected export type.</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276976"></a>

          <p class="pBody"><code class="cCode">dwOptionsIn</code></p>
        </td>

        <td>
          <a name="wp1276978"></a>

          <p class="pBody">See "<a href="File_System.html#wp546831">Understanding File I/O input flags</a>."</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276980"></a>

          <p class="pBody"><code class="cCode">lpdwOptionsOut</code></p>
        </td>

        <td>
          <a name="wp1276982"></a>

          <p class="pBody">See "<a href="File_System.html#wp546831">Understanding File I/O input flags</a>."</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276984"></a>

          <p class="pBody"><code class="cCode">pfnQueryCnt</code></p>
        </td>

        <td>
          <a name="wp1276986"></a>

          <p class="pBody">Is reserved for future use; should be set to <code class="cCode">NULL</code></p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276988"></a>

          <p class="pBody"><code class="cCode">pfnFormat</code></p>
        </td>

        <td>
          <a name="wp1276990"></a>

          <p class="pBody">Is reserved for future use; should be set to <code class="cCode">NULL</code></p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1276992"></a>

          <p class="pBody"><code class="cCode">dwCvtClass</code></p>
        </td>

        <td>
          <a name="wp1276994"></a>

          <p class="pBody">Contains the combination of the classes of files to list in the Format list. Any combination of the following can be used:</p>

          <div class="pSmartList1 pSmartList1 c1">
            <a name="wp1276995"></a>

            <div class="pSmartList1">
              <ul>
                <li><code class="cCode">CVT_CLASS_DOC</code> - document or text files</li>
              </ul>
            </div><a name="wp1276996"></a>

            <div class="pSmartList1">
              <ul>
                <li><code class="cCode">CVT_CLASS_SS</code> - spreadsheet files</li>
              </ul>
            </div><a name="wp1276997"></a>

            <div class="pSmartList1">
              <ul>
                <li><code class="cCode">CVT_CLASS_GR</code> - graphics files</li>
              </ul>
            </div><a name="wp1276998"></a>

            <div class="pSmartList1">
              <ul>
                <li><code class="cCode">CVT_CLASS_DB</code> - database files</li>
              </ul>
            </div><a name="wp1276999"></a>

            <div class="pSmartList1">
              <ul>
                <li><code class="cCode">CVT_CLASS_ALL</code> - all files</li>
              </ul>
            </div>
          </div>
        </td>
      </tr>
    </table>
  </div>

  <p class="pBody"></p><a name="wp547678"></a>

  <h5 class="pHeading4">Return values</h5><a name="wp547680"></a>

  <p class="pBody">This function returns zero if <code class="cCode">Cancel</code> is pressed; otherwise, it returns one of the values listed in the following
  table. If the specified filename is too long, it is truncated to an eight-character file prefix followed by a period ( . ) and a three-character file
  extension.</p><a name="wp547683"></a>

  <p class="pBody"></p>

  <div class="c2">
    <table border="1">
      <tr align="left">
        <td>
          <a name="wp519118"></a>

          <h5 class="pHeading4">Return value</h5>
        </td>

        <td>
          <a name="wp519120"></a>

          <h5 class="pHeading4">Condition</h5>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp519126"></a>

          <p class="pBody"><code class="cCode">FS_EMPTY</code></p>
        </td>

        <td>
          <a name="wp519128"></a>

          <p class="pBody">Indicates that the file specification was empty</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp519134"></a>

          <p class="pBody"><code class="cCode">FS_INVALIDDRIVE</code></p>
        </td>

        <td>
          <a name="wp519136"></a>

          <p class="pBody">Indicates that the specified drive is invalid</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp519142"></a>

          <p class="pBody"><code class="cCode">FS_INVALIDDIR</code></p>
        </td>

        <td>
          <a name="wp519144"></a>

          <p class="pBody">Indicates that the specified folder does not exist</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp519150"></a>

          <p class="pBody"><code class="cCode">FS_INVALIDFILENAME</code></p>
        </td>

        <td>
          <a name="wp519152"></a>

          <p class="pBody">Indicates that the specified filename was invalid</p>
        </td>
      </tr>
    </table>
  </div>

  <p class="pBody"></p>
</body>
</html>
