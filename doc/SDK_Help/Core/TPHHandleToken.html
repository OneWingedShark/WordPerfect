<?xml version="1.0" encoding="iso-8859-1"?>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
  <meta name="LASTUPDATED" content="01/20/12 16:19:27" />

  <title>TPHHandleToken function</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
  <style type="text/css">
/*<![CDATA[*/
  div.c1 {text-align: left}
  /*]]>*/
  </style>
</head>

<body>
  <table border="0" width="100%">
    <tr>
      <td width="23"><a href="TPHExit.html"><img alt="Previous Document" border="0" src="images/prev.gif" width="18" height="18" /></a></td>
      <td width="23"><a href="SDK_TOC.html"><img alt="Table Of Contents" border="0" src="images/BtnBacktoTop.gif" width="18" height="18" /></a></td>
      <td width="23"><a href="TPHValidateToken.html"><img alt="Next Document" border="0" src="images/next.gif" width="18" height="18" /></a></td>

      <td>
        <p class="pBody"><a href="Third_Party_DLL_Entry_Points.html">Using entry points in Third Party Handler DLLs</a> : <a href=
        "Functions_needing_to_be_defined_in_a_Third_Party_DLL.html">Defining required functions in Third Party Handler DLLs</a> : TPHHandleToken function</p>
      </td>
    </tr>
  </table>
  <hr width="100%" size="1" color="#0000CC" />
  <a name="wp554450"></a>

  <h4 class="pHeading3">TPHHandleToken function</h4><a name="wp554452"></a>

  <p class="pBody">PerfectFit calls this function every time it recieves a command from a Corel&nbsp;WordPerfect&nbsp;Office WOAPI application. Command values
  and their associated parameters are passed to this function. The DLL must respond by ignoring or blocking the command. Optionally, additional PerfectScript
  commands can be sent back to the Corel&nbsp;WordPerfect&nbsp;Office WOAPI application to be processed.</p><a name="wp554454"></a>

  <p class="pBody">A PerfectScript command falls into one of two categories: non-value-returning or value-returning. Some commands, such as <code class=
  "cCode">FileOpen</code>, do not need to include any return information as a result of the call. This type of command is classified as a non-value-returning
  command. Other commands, such as <code class="cCode">?Page</code>, have been provided that return data. In the file created by the Resource Dump utility,
  these types are identified as <code class="cCode">"Return Value: None"</code>, or <code class="cCode">"Return Value: type"</code>, where type refers to the
  type of data returned, such as ANSI string, integer, and so forth. The default return value for this function should be <code class=
  "cCode">DLL_HAN_NOT_HANDLED</code> to ignore the command.</p><a name="wp1269835"></a>

  <p class="pBody">This function must be exported as ordinal value <code class="cCode">6</code>.</p><a name="wp554456"></a>

  <h5 class="pHeading4">C Prototype</h5>

  <div class="pPreformatted">
    <pre class="pPreformatted">
int FAR PASCAL TPHHandleToken ( LPTPH_RETURNVAL lpRetData,<a name="wp554458"> </a>
HWND hLinkWnd,<a name="wp554460"> </a>
WORD msg );<a name="wp554462"> </a>
</pre>
  </div><a name="wp554464"></a>

  <h5 class="pHeading4">Pascal Prototype</h5>

  <div class="pPreformatted">
    <pre class="pPreformatted">
function TPHHandleToken ( lpRetData: LPTPH_RETURNVAL;<a name="wp554466"> </a>
hLinkWnd:  HWND;<a name="wp554468"> </a>
msg:  WORD ): integer;<a name="wp554470"> </a>
</pre>
  </div><a name="wp554472"></a>

  <h5 class="pHeading4">Parameters</h5><a name="wp554475"></a>

  <p class="pBody"></p>

  <div class="c1">
    <table border="1">
      <tr align="left">
        <td>
          <a name="wp524588"></a>

          <p class="pBody"><code class="cCode">lpRetData</code></p>
        </td>

        <td>
          <a name="wp524590"></a>

          <p class="pBody">Sets the long pointer to a <code class="cCode">TPH_RETURNVAL</code> structure</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524596"></a>

          <p class="pBody"><code class="cCode">hLinkWnd</code></p>
        </td>

        <td>
          <a name="wp524598"></a>

          <p class="pBody">Specifies the handle to the application's link window. It is through this window that a Corel&nbsp;WordPerfect&nbsp;Office WOAPI
          application receives messages from a third-party DLL.</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524604"></a>

          <p class="pBody"><code class="cCode">msg</code></p>
        </td>

        <td>
          <a name="wp524606"></a>

          <p class="pBody">Sets the link window message type. Currently supports only supports <code class="cCode">WPLM_EXECUTE_TOKEN</code> message types.</p>
        </td>
      </tr>
    </table>
  </div>

  <p class="pBody"></p><a name="wp554477"></a>

  <h5 class="pHeading4">Return values</h5><a name="wp554480"></a>

  <p class="pBody"></p>

  <div class="c1">
    <table border="1">
      <tr align="left">
        <td>
          <a name="wp524617"></a>

          <h5 class="pHeading4">Type</h5>
        </td>

        <td>
          <a name="wp524619"></a>

          <h5 class="pHeading4">Description</h5>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524625"></a>

          <p class="pBody"><code class="cCode">DLL_HAN_NOT_HANDLED</code></p>
        </td>

        <td>
          <a name="wp524627"></a>

          <p class="pBody">Indicates that the command was not processed</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524633"></a>

          <p class="pBody"><code class="cCode">DLL_HAN_NO_ERROR</code></p>
        </td>

        <td>
          <a name="wp524635"></a>

          <p class="pBody">Indicates that the command was processed. This value should be returned to block a PerfectScript command.</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524641"></a>

          <p class="pBody"><code class="cCode">DLL_HAN_NOT_FOUND</code></p>
        </td>

        <td>
          <a name="wp524643"></a>

          <p class="pBody">Indicates that the command resulted in a Not Found condition</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524649"></a>

          <p class="pBody"><code class="cCode">DLL_HAN_CANCEL</code></p>
        </td>

        <td>
          <a name="wp524651"></a>

          <p class="pBody">Indicates that the user canceled the function</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524657"></a>

          <p class="pBody"><code class="cCode">DLL_HAN_TOKEN_ERROR</code></p>
        </td>

        <td>
          <a name="wp524659"></a>

          <p class="pBody">Indicates that the command was not valid</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524665"></a>

          <p class="pBody"><code class="cCode">DLL_HAN_PARM_ERROR</code></p>
        </td>

        <td>
          <a name="wp524667"></a>

          <p class="pBody">Indicates that one or more of the parameters were invalid</p>
        </td>
      </tr>
    </table>
  </div>

  <p class="pBody"></p><a name="wp554482"></a>

  <h5 class="pHeading4">C sample</h5><a name="wp554484"></a>

  <p class="pBody">This example uses the dynatheta ID, created in the <a href="TPHEntry.html#wp554321">TPHEntry( )</a> sample, to bring up a message box if a
  user has selected the new menu or toolbar item.</p>

  <div class="pPreformatted">
    <pre class="pPreformatted">
int FAR PASCAL TPHHandleToken ( LPTPH_RETURNVAL lpRetData,<a name="wp554486"> </a>
HWND  hLinkWnd,<a name="wp554488"> </a>
WORD  msg)<a name="wp554490"> </a>
{<a name="wp554492"> </a>
  /* Verify that the command came from WordPerfect */<a name="wp554494"> </a>
  if(lpRetData-&gt; lpTokenData-&gt; atomApp == aWP)<a name="wp554496"> </a>
  {<a name="wp554498"> </a>
    /* Menu or button selected */<a name="wp554500"> </a>
    if( lpRetData-&gt; lpTokenData-&gt; wTokenID == dWPWPThetaID)<a name="wp554502"> </a>
    {<a name="wp554504"> </a>
      MessageBox( NULL, "Item selected", "Command", MB_OK);<a name="wp554506"> </a>
    }<a name="wp554508"> </a>
  }<a name="wp554510"> </a>
  return DLL_HAN_NOT_HANDLED;<a name="wp554512"> </a>
}<a name="wp554514"> </a>
</pre>
  </div><a name="wp554516"></a>

  <h5 class="pHeading4">Pascal sample</h5>

  <div class="pPreformatted">
    <pre class="pPreformatted">
function TPHHandleToken ( lpRetData: LPTPH_RETURNVAL;<a name="wp554518"> </a>
hLinkWnd: HWND;<a name="wp554520"> </a>
msg:WORD ): integer;<a name="wp554522"> </a>
begin<a name="wp554524"> </a>
  { Verify that the command came from WordPerfect }<a name="wp554526"> </a>
  if( lpRetData^.lpTokenData^.atomApp = aWP )then<a name="wp554528"> </a>
  begin<a name="wp554530"> </a>
    { Menu or button selected }<a name="wp554532"> </a>
    if( lpRetData^.lpTokenData^.wTokenID = dWPWPThetaID )then<a name="wp554534"> </a>
    begin<a name="wp554536"> </a>
      ShowMessage( 'Item selected');<a name="wp554538"> </a>
    end;<a name="wp554540"> </a>
  end;<a name="wp554542"> </a>
  result:= DLL_HAN_NO_ERROR; <a name="wp554544"> </a>
end;<a name="wp554546"> </a>
</pre>
  </div>
</body>
</html>
