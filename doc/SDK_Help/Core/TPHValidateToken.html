<?xml version="1.0" encoding="iso-8859-1"?>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
  <meta name="LASTUPDATED" content="01/20/12 16:19:27" />

  <title>TPHValidateToken function</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
  <style type="text/css">
/*<![CDATA[*/
  div.c1 {text-align: left}
  /*]]>*/
  </style>
</head>

<body>
  <table border="0" width="100%">
    <tr>
      <td width="23"><a href="TPHHandleToken.html"><img alt="Previous Document" border="0" src="images/prev.gif" width="18" height="18" /></a></td>
      <td width="23"><a href="SDK_TOC.html"><img alt="Table Of Contents" border="0" src="images/BtnBacktoTop.gif" width="18" height="18" /></a></td>
      <td width="23"><a href="TPHMultipleInstance.html"><img alt="Next Document" border="0" src="images/next.gif" width="18" height="18" /></a></td>

      <td>
        <p class="pBody"><a href="Third_Party_DLL_Entry_Points.html">Using entry points in Third Party Handler DLLs</a> : <a href=
        "Functions_needing_to_be_defined_in_a_Third_Party_DLL.html">Defining required functions in Third Party Handler DLLs</a> : TPHValidateToken function</p>
      </td>
    </tr>
  </table>
  <hr width="100%" size="1" color="#0000CC" />
  <a name="wp554562"></a>

  <h4 class="pHeading3">TPHValidateToken function</h4><a name="wp554564"></a>

  <p class="pBody">PerfectFit calls this function every time a menu is selected in a Corel&nbsp;WordPerfect&nbsp;Office WOAPI application. It does this to
  verify that a token (theta) associated with a menu item is valid. This allows a Third Party DLL to control the display of an menu item on an application's
  menu.</p><a name="wp1269936"></a>

  <p class="pBody">The default return value for this function should be <code class="cCode">DLL_VAL_UNKNOWN_TOKEN</code>.</p><a name="wp1269940"></a>

  <p class="pBody">This function must be exported as ordinal value <code class="cCode">7</code>.</p><a name="wp554566"></a>

  <h5 class="pHeading4">C Prototype</h5>

  <div class="pPreformatted">
    <pre class="pPreformatted">
DWORD FAR PASCAL TPHValidateToken ( LPMAC_TOKEN lpTokenData, <a name="wp554568"> </a>
        LPVOID lpDataTypeInfo );<a name="wp554570"> </a>
</pre>
  </div><a name="wp554572"></a>

  <h5 class="pHeading4">Pascal Prototype</h5>

  <div class="pPreformatted">
    <pre class="pPreformatted">
function TPHValidateToken ( lpTokenData: LPMAC_TOKEN; <a name="wp554574"> </a>
        lpDataTypeInfo: Pointer ): DWORD;<a name="wp554576"> </a>
</pre>
  </div><a name="wp554578"></a>

  <h5 class="pHeading4">Parameters</h5><a name="wp554581"></a>

  <p class="pBody"></p>

  <div class="c1">
    <table border="1">
      <tr align="left">
        <td>
          <a name="wp524678"></a>

          <p class="pBody"><code class="cCode">lpTokenData</code></p>
        </td>

        <td>
          <a name="wp524680"></a>

          <p class="pBody">Sets the long pointer to a <code class="cCode">MAC_TOKEN</code> structure</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524686"></a>

          <p class="pBody"><code class="cCode">lpDataTypeInfo</code></p>
        </td>

        <td>
          <a name="wp524688"></a>

          <p class="pBody">Sets the long pointer to a <code class="cCode">TPValInfo</code> structure</p>
        </td>
      </tr>
    </table>
  </div>

  <p class="pBody"></p><a name="wp554583"></a>

  <h5 class="pHeading4">Return values</h5><a name="wp554585"></a>

  <p class="pBody">The return value should be a <code class="cCode">DWORD</code> value containing the appropriate low-order and high-order word
  values.</p><a name="wp1269993"></a>

  <p class="pBody">Here are the available low-order word (<code class="cCode">LOWORD</code>) values:</p><a name="wp554588"></a>

  <p class="pBody"></p>

  <div class="c1">
    <table border="1">
      <tr align="left">
        <td>
          <a name="wp524707"></a>

          <p class="pBody"><code class="cCode">DLL_VAL_UNKNOWN_TOKEN</code></p>
        </td>

        <td>
          <a name="wp524709"></a>

          <p class="pBody">Indicates that the command is not recognized by the DLL</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524715"></a>

          <p class="pBody"><code class="cCode">DLL_VAL_VALIDATED</code></p>
        </td>

        <td>
          <a name="wp524717"></a>

          <p class="pBody">Indicates that the command was validated by the DLL</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524723"></a>

          <p class="pBody"><code class="cCode">DLL_VAL_UNVALIDATED</code></p>
        </td>

        <td>
          <a name="wp524725"></a>

          <p class="pBody">Indicates that the command was invalidated by the DLL</p>
        </td>
      </tr>
    </table>
  </div>

  <p class="pBody"></p><a name="wp554591"></a>

  <p class="pBody">Here are the available high-order word (<code class="cCode">HIWORD</code>) values:</p><a name="wp1270007"></a>

  <p class="pBody"></p>

  <div class="c1">
    <table border="1">
      <tr align="left">
        <td>
          <a name="wp524744"></a>

          <p class="pBody"><code class="cCode">MT_MENU_ITEM_CHECKED</code></p>
        </td>

        <td>
          <a name="wp524746"></a>

          <p class="pBody">Changes the menu item state to be checked</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524752"></a>

          <p class="pBody"><code class="cCode">MT_MENU_ITEM_UNCHECKED</code></p>
        </td>

        <td>
          <a name="wp524754"></a>

          <p class="pBody">Changes the menu item state to be unchecked</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524760"></a>

          <p class="pBody"><code class="cCode">MT_MENU_ITEM_ENABLED</code></p>
        </td>

        <td>
          <a name="wp524762"></a>

          <p class="pBody">Enables the menu item</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524768"></a>

          <p class="pBody"><code class="cCode">MT_MENU_ITEM_GRAYED</code></p>
        </td>

        <td>
          <a name="wp524770"></a>

          <p class="pBody">Grays the menu item</p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp524776"></a>

          <p class="pBody"><code class="cCode">MT_MENU_ITEM_TRISTATE</code></p>
        </td>

        <td>
          <a name="wp524778"></a>

          <p class="pBody">Indicates that the item may be in an indeterminate state</p>
        </td>
      </tr>
    </table>
  </div>

  <p class="pBody"></p><a name="wp554593"></a>

  <h5 class="pHeading4">C sample</h5>

  <div class="pPreformatted">
    <pre class="pPreformatted">
DWORD FAR PASCAL TPHValidateToken ( LPMAC_TOKEN lpTokenData, <a name="wp554595"> </a>
        LPVOID lpDataType )<a name="wp554597"> </a>
{<a name="wp554599"> </a>
  /* Enable my dynatheta menu item */<a name="wp554601"> </a>
  if (lpTokenData-&gt;wTokenID == dWPWPThetaID)<a name="wp554603"> </a>
  {<a name="wp554605"> </a>
    return (DWORD)DLL_VAL_VALIDATED|MT_MENU_ITEM_ENABLED;<a name="wp554607"> </a>
  }<a name="wp554609"> </a>
  else<a name="wp554611"> </a>
  {<a name="wp554613"> </a>
    return DLL_VAL_UNKNOWN_TOKEN;<a name="wp554615"> </a>
  }<a name="wp554617"> </a>
} <a name="wp554619"> </a>
</pre>
  </div><a name="wp554621"></a>

  <h5 class="pHeading4">Pascal sample</h5>

  <div class="pPreformatted">
    <pre class="pPreformatted">
function TPHValidateToken ( lpTokenData: LPMAC_TOKEN; <a name="wp554623"> </a>
lpDataTypeInfo: Pointer ): DWORD; <a name="wp554625"> </a>
begin<a name="wp554627"> </a>
  { Enable my dynatheta menu item }<a name="wp554629"> </a>
  if (lpTokenData^.wTokenID = dWPWPThetaID) then<a name="wp554631"> </a>
  begin<a name="wp554633"> </a>
    result:= DWORD(DLL_VAL_VALIDATED or MT_MENU_ITEM_ENABLED);<a name="wp554635"> </a>
  end<a name="wp554637"> </a>
  else<a name="wp554639"> </a>
  begin<a name="wp554641"> </a>
    result:= DLL_VAL_UNKNOWN_TOKEN;<a name="wp554643"> </a>
  end;<a name="wp554645"> </a>
end;<a name="wp554647"> </a>
</pre>
  </div>
</body>
</html>
