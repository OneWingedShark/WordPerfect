<?xml version="1.0" encoding="iso-8859-1"?>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Understanding Windows Open API (WOAPI)</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
  <style type="text/css">
/*<![CDATA[*/
  div.c1 {text-align: left}
  /*]]>*/
  </style>
</head>

<body>
  <table border="0" width="100%">
    <tr>
      <td width="23"><a href="Understanding_TPH.html"><img alt="Previous Document" border="0" src="images/prev.gif" width="18" height="18" /></a></td>
      <td width="23"><a href="SDK_TOC.html"><img alt="Table Of Contents" border="0" src="images/BtnBacktoTop.gif" width="18" height="18" /></a></td>
      <td width="23"><a href="Third_Party_DLL_chains.html"><img alt="Next Document" border="0" src="images/next.gif" width="18" height="18" /></a></td>

      <td>
        <p class="pBody"><a href="Understanding_SDK_tech.html">Understanding the SDK technologies</a> : <a href="Understanding_TPH.html">Understanding Third
        Party Handlers</a> : Understanding Windows Open API (WOAPI)</p>
      </td>
    </tr>
  </table>
  <hr width="100%" size="1" color="#0000CC" />
  <a name="wp1269274"></a>

  <h4 class="pHeading3">Understanding Windows Open API (WOAPI)</h4><a name="wp1269275"></a>

  <p class="pBody">WordPerfect and Presentations are command-driven applications. In a command-driven application, low-level events such as a mouse click or
  key press are packaged into high-level events such as <code class="cCode">Load a Button Bar</code>, <code class="cCode">Open a File</code>, or <code class=
  "cCode">Close an Application</code>. Command, macro command, token, macro token, and theta are all essentially the same; they all refer to an event that has
  been or can be triggered.</p><a name="wp1269279"></a>

  <p class="pBody">All Corel&nbsp;WordPerfect&nbsp;Office applications use a common set of code stored as DLLs. This group of DLLs is referred to as PerfectFit
  or Shared Code. When a Corel&nbsp;WordPerfect&nbsp;Office application is loaded, PerfectFit is also loaded.</p><a name="wp1269283"></a>

  <p class="pBody">The Windows Open API (WOAPI) is a set of functions that facilitates a communications link between some Corel&nbsp;WordPerfect&nbsp;Office
  application and a Third Party DLL. PerfectFit calls these functions by ordinal value. The functions allow the DLL to 1) initialize, 2) monitor the
  applications command flow, and 3) uninitialize. The following table shows the functions:</p><a name="wp1270162"></a>

  <p class="pBody"></p>

  <div class="c1">
    <table border="1">
      <tr align="left">
        <td>
          <a name="wp1270169"></a>

          <h5 class="pHeading4">Event</h5>
        </td>

        <td>
          <a name="wp1270171"></a>

          <h5 class="pHeading4">Functions</h5>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1270173"></a>

          <p class="pBody">Initialization</p>
        </td>

        <td>
          <a name="wp1270222"></a>

          <p class="pBody"><code class="cCode">TPHVersion()</code></p><a name="wp1270223"></a>

          <p class="pBody"><code class="cCode">TPHCompatibility()</code></p><a name="wp1270223"></a>

          <p class="pBody"><code class="cCode">TPHMultipleInstance()</code></p><a name="wp1270224"></a>

          <p class="pBody"><code class="cCode">TPHTimeStamp()</code></p><a name="wp1270175"></a>

          <p class="pBody"><code class="cCode">TPHEntry()</code></p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1270177"></a>

          <p class="pBody">Monitoring</p>
        </td>

        <td>
          <a name="wp1270229"></a>

          <p class="pBody"><code class="cCode">TPHHandleToken()</code></p><a name="wp1270179"></a>

          <p class="pBody"><code class="cCode">TPHValidateToken()</code></p>
        </td>
      </tr>

      <tr align="left">
        <td>
          <a name="wp1270201"></a>

          <p class="pBody">Uninitialization</p>
        </td>

        <td>
          <a name="wp1270203"></a>

          <p class="pBody"><code class="cCode">TPHExit()</code></p>
        </td>
      </tr>
    </table>
  </div>

  <p class="pBody"></p><a name="wp1269298"></a>

  <p class="pBody">For detailed technical information on each function, please refer to the section "<a href="Third_Party_DLL_Entry_Points.html#wp554034">Using
  entry points in Third Party Handler DLLs</a>."</p><a name="wp1269302"></a>

  <p class="pBody">When a Corel&nbsp;WordPerfect&nbsp;Office application loads, PerfectFit attempts to load any associated Third Party DLLs. To initialize the
  DLL and to verify that the DLL can be loaded, PerfectFit calls each of the initialization functions. New for X6, <code class=
  "cCode">TPHMultipleInstance</code> is called to initialize information relating to multiple instances of WP.</p><a name="wp1269303"></a>

  <p class="pBody">If the initialization is successful, PerfectFit begins directing the command flow of the WOAPI applications through the DLL's <code class=
  "cCode">TPHHandleToken()</code> function. The Third Party DLL must respond accordingly in <code class="cCode">TPHHandleToken()</code> by ignoring or blocking
  each command. The DLL also has the option of sending additional commands, by adding them to the applications command flow. For detailed information on
  ignoring, blocking, or sending commands, please refer to the section "<a href="PerfectScript_command_flow.html#wp1269362">Understanding PerfectScript command
  flow</a>."</p><a name="wp1269305"></a>

  <p class="pBody">Not all PerfectScript commands can be monitored in the <code class="cCode">TPHHandleToken()</code> function. For example, the macro commands
  <code class="cCode">FOR</code>, <code class="cCode">IF</code>, <code class="cCode">QUIT</code>, and <code class="cCode">WAIT</code> cannot be monitored. See
  the text files in the Include folder.</p>
</body>
</html>
